[gd_scene load_steps=4 format=3 uid="uid://c5nf542k6cnsb"]

[ext_resource type="Texture2D" uid="uid://bv21kk0km1rc" path="res://icon.svg" id="1_4flbx"]

[sub_resource type="GDScript" id="GDScript_4flbx"]
script/source = "extends CharacterBody2D

var speed = 400.0
var acceleration = 800.0
var friction = 800.0

func _physics_process(delta):
	var direction = Input.get_vector(\"move_left\", \"move_right\", \"move_up\", \"move_down\")

	if direction:
		velocity = velocity.move_toward(direction * speed, acceleration * delta)
		print(\"Velcoidade: \", velocity)
		rotation = velocity.angle() # Gira o trator
	else:
		velocity = velocity.move_toward(Vector2.ZERO, friction * delta)

	move_and_slide()

	# Detectar colisão
	for i in get_slide_collision_count():
		var collision = get_slide_collision(i)
		var collider = collision.get_collider()

		if collider.is_in_group(\"obstaculos\"):
			# Dano baseado na velocidade atual
			
			var damage = velocity.length() * 0.2
			if collider.has_method(\"take_damage\"):
				collider.take_damage(damage)
				

			# Pulo para trás (impacto)
			velocity = velocity.bounce(collision.get_normal()) * 0.5
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_4flbx"]
size = Vector2(64, 64)

[node name="Player" type="CharacterBody2D"]
script = SubResource("GDScript_4flbx")

[node name="Sprite2D" type="Sprite2D" parent="."]
scale = Vector2(0.5, 0.5)
texture = ExtResource("1_4flbx")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
shape = SubResource("RectangleShape2D_4flbx")

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(1.5, 1.5)
position_smoothing_enabled = true
